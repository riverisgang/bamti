# -*- coding: utf-8 -*-
import streamlit as st
import random
from PIL import Image
import numpy as np
import colorsys
import re
import openai

# ---------------- ê¸°ë³¸ ì„¤ì • ----------------
st.set_page_config(
    page_title="BAME - Bamti Escape",
    page_icon="ğŸ’œ",
    layout="wide",
)

st.sidebar.title("BAME")
openai.api_key = st.secrets["openai"]["api_key"]

# ---------------- ê³µìš© í•¨ìˆ˜ ----------------
def line():
    st.markdown("---")

def rgb_to_hex(rgb):
    return "#{:02X}{:02X}{:02X}".format(*rgb)

def hex_to_rgb(hex_color):
    hex_color = hex_color.strip().lstrip("#")
    if len(hex_color) == 6:
        return tuple(int(hex_color[i:i+2], 16) for i in (0, 2, 4))
    return None

def image_center_crop(np_image, ratio=0.5):
    h, w, _ = np_image.shape
    ch = int(h * ratio)
    cw = int(w * ratio)
    h_start = (h - ch) // 2
    w_start = (w - cw) // 2
    return np_image[h_start:h_start+ch, w_start:w_start+cw, :]

def calc_mean_color(np_image):
    crop = image_center_crop(np_image, ratio=0.5)
    avg = crop.mean(axis=(0, 1)).astype(int)
    return tuple(avg)

def calc_mean_hsv(np_image):
    crop = image_center_crop(np_image, ratio=0.5)
    pixels = crop.reshape(-1, 3) / 255.0
    hsv = np.array([colorsys.rgb_to_hsv(*p) for p in pixels])
    h_mean = float(np.mean(hsv[:, 0])) * 360.0
    s_mean = float(np.mean(hsv[:, 1])) * 100.0
    v_mean = float(np.mean(hsv[:, 2])) * 100.0
    return (round(h_mean, 1), round(s_mean, 1), round(v_mean, 1))

def show_color_block(rgb, caption=None):
    block = np.zeros((60, 60, 3), dtype=np.uint8)
    block[:, :] = rgb
    st.image(block, caption=caption if caption else rgb_to_hex(rgb), use_column_width=False)

def parse_lines(text):
    lines = [l.strip() for l in text.split("\n") if l.strip()]
    cleaned = []
    for l in lines:
        cleaned.append(re.sub(r"^[\-\d\.\)\s]+", "", l))
    return cleaned

# ---------------- í¼ìŠ¤ë„ ì»¬ëŸ¬ ë¶„ë¥˜ ----------------
def seasonal_classify(h, s, v):
    if 20 <= h <= 50 and s > 40 and v > 60:
        return "ë´„ì›œ (Spring Warm)"
    elif 150 <= h <= 200 and s < 40 and v > 50:
        return "ì—¬ë¦„ì¿¨ (Summer Cool)"
    elif 30 <= h <= 60 and s > 40 and v < 60:
        return "ê°€ì„ì›œ (Autumn Warm)"
    elif 180 <= h <= 260 and v > 60:
        return "ê²¨ìš¸ì¿¨ (Winter Cool)"
    else:
        return "ì¤‘ë¦½í†¤ (Neutral)"

palettes = {
    "ë´„ì›œ (Spring Warm)": ["#FFD1DC", "#FFFACD", "#B0E0E6"],
    "ì—¬ë¦„ì¿¨ (Summer Cool)": ["#AEC6CF", "#CFCFC4", "#E6E6FA"],
    "ê°€ì„ì›œ (Autumn Warm)": ["#C19A6B", "#556B2F", "#FFD700"],
    "ê²¨ìš¸ì¿¨ (Winter Cool)": ["#0000FF", "#000000", "#FFFFFF"],
    "ì¤‘ë¦½í†¤ (Neutral)": ["#808080", "#D3D3D3", "#A9A9A9"]
}

# ---------------- ì‚¬ì´ë“œ í˜ì´ì§€ ----------------
page = st.sidebar.radio(
    "ë©”ë‰´ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”",
    [
        "HOME ğŸ ",
        "ëŒ€í™” ì½”ì¹˜ ğŸ’¬",
        "íŒ¨ì…˜ & í¼ìŠ¤ë„ ì»¬ëŸ¬ ğŸ‘—",
        "SNS ë¸Œëœë”© ğŸ“¸",
        "ìš”ì¦˜ ë°ˆ ì„¤ëª… ğŸ˜‚",
        "ì˜¤ëŠ˜ì˜ ë°¤í‹° ì ìˆ˜ ğŸ”®",
    ],
)

# =========================================================
# HOME
# =========================================================
if page == "HOME ğŸ ":
    st.markdown("## BAME (Bamti Escape)")
    line()
    st.write("í˜„ëŒ€ì¸ì˜ ì†Œí†µ ë¶€ë‹´, íŒ¨ì…˜ ê³ ë¯¼, SNS ê²½ìŸë ¥ ë¶€ì¡±ì„ í•œ ë²ˆì— í•´ê²°í•˜ëŠ” í†µí•©í˜• ìê¸°ê´€ë¦¬ ì•±")

# =========================================================
# ëŒ€í™” ì½”ì¹˜
# =========================================================
elif page == "ëŒ€í™” ì½”ì¹˜ ğŸ’¬":
    st.markdown("## ëŒ€í™” ì½”ì¹˜ ğŸ’¬")
    line()
    rel = st.selectbox("ìƒëŒ€ë°©ê³¼ì˜ ê´€ê³„ ğŸ‘€", ["ì¹œêµ¬", "ì¸/ì—°ì• ", "ê°€ì¡±", "ì„ ë°°/í›„ë°°", "ì„ ìƒë‹˜/ë©˜í† ", "ê¸°íƒ€"])
    mood = st.selectbox("ëŒ€í™” ë¶„ìœ„ê¸° ğŸ˜¶", ["ì˜ ëª¨ë¥´ê² ìŒ", "ê¸°ë¶„ ì¢‹ìŒ ğŸ™‚", "ì‚´ì§ ì˜ˆë¯¼í•¨ ğŸ˜¶â€ğŸŒ«ï¸", "í˜ë“¤ì–´ ë³´ì„ ğŸ˜¢", "ì¥ë‚œì¹˜ëŠ” ë¶„ìœ„ê¸° ğŸ˜‚"])
    chat_log = st.text_area("ìµœê·¼ ëŒ€í™” ë‚´ìš© âœï¸", height=200)

    if st.button("ğŸ’¡ ë‹µë³€ ì¶”ì²œ ë°›ê¸°"):
        if not chat_log.strip():
            st.warning("ëŒ€í™” ë‚´ìš©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.")
        else:
            prompt = f"""
ìƒëŒ€ë°©ê³¼ì˜ ê´€ê³„: {rel}
ëŒ€í™” ë¶„ìœ„ê¸°: {mood}
ìµœê·¼ ëŒ€í™”:
{chat_log}

ìƒí™©ì„ ìì—°ìŠ¤ëŸ½ê²Œ ì´ì–´ê°€ë©° ë¶€ë‹´ ì—†ê³  ë”°ëœ»í•œ 3ê°€ì§€ ë‹µë³€ì„ ë§Œë“¤ì–´ì¤˜.
"""
            response = openai.chat.completions.create(
                model="gpt-4o-mini",
                messages=[{"role":"user","content":prompt}],
                temperature=0.7,
            )
            ai_replies = parse_lines(response.choices[0].message.content.strip())
            for i, msg in enumerate(ai_replies[:3], start=1):
                st.info(f"ì¶”ì²œ ë‹µë³€ {i}\n\n{msg}")

# =========================================================
# íŒ¨ì…˜ & í¼ìŠ¤ë„ ì»¬ëŸ¬
# =========================================================
elif page == "íŒ¨ì…˜ & í¼ìŠ¤ë„ ì»¬ëŸ¬ ğŸ‘—":
    st.markdown("## í¼ìŠ¤ë„ ì»¬ëŸ¬ & ì½”ë”” ì¶”ì²œ ğŸ‘—")
    line()
    style_mood = st.selectbox(
        "ì˜¤ëŠ˜ì˜ ìŠ¤íƒ€ì¼ ë¬´ë“œ ğŸ˜",
        ["ê·€ì—½ê²Œ ğŸ’•", "ì‹œí¬í•˜ê²Œ ğŸ–¤", "ê³µë¶€í•˜ëŸ¬ ê°€ëŠ” ë‚  ğŸ“š", "ì‚¬ì§„ ë§ì´ ì°ëŠ” ë‚  ğŸ“¸", "í¸í•˜ê²Œ ğŸ›‹ï¸"]
    )
    uploaded_image = st.file_uploader("ì–¼êµ´ ì‚¬ì§„ ì—…ë¡œë“œ ğŸ“¸", type=["jpg","jpeg","png"])

    if st.button("ğŸ‘— í¼ìŠ¤ë„ ì»¬ëŸ¬ + ì½”ë”” ë¶„ì„"):
        if not uploaded_image:
            st.warning("ì–¼êµ´ ì‚¬ì§„ì„ ì—…ë¡œë“œ í•´ ì£¼ì„¸ìš”.")
        else:
            image = Image.open(uploaded_image).convert("RGB")
            np_image = np.array(image)
            avg_rgb = calc_mean_color(np_image)
            h_mean, s_mean, v_mean = calc_mean_hsv(np_image)
            season = seasonal_classify(h_mean, s_mean, v_mean)

            st.write(f"ë¶„ë¥˜ ê²°ê³¼: {season}")
            st.write("ì¶”ì²œ íŒ”ë ˆíŠ¸:")
            for hex_color in palettes[season]:
                show_color_block(hex_to_rgb(hex_color), caption=hex_color)

            # AI ì½”ë”” ì¶”ì²œ
            prompt = f"""
ë‹¹ì‹ ì˜ í¼ìŠ¤ë„ ì»¬ëŸ¬ëŠ” {season} ì…ë‹ˆë‹¤.
ì˜¤ëŠ˜ì˜ ìŠ¤íƒ€ì¼ ë¬´ë“œëŠ” {style_mood} ì…ë‹ˆë‹¤.

í¼ìŠ¤ë„ ì»¬ëŸ¬ì™€ ë¬´ë“œì— ë§ëŠ” ì˜¤ëŠ˜ì˜ ì½”ë””ë¥¼ ì¶”ì²œí•´ì¤˜.
- ìƒì˜/í•˜ì˜/ì›í”¼ìŠ¤/ì•¡ì„¸ì„œë¦¬/ì‹ ë°œ ì¤‘ 3~4ê°€ì§€ ì•„ì´í…œ
- ìƒ‰ìƒì€ í¼ìŠ¤ë„ ì»¬ëŸ¬ íŒ”ë ˆíŠ¸ì™€ ì˜ ì–´ìš¸ë¦¬ê²Œ
- ì„¤ëª…ì€ ê°„ë‹¨í•˜ê³  ì§ê´€ì ìœ¼ë¡œ
"""
            response = openai.chat.completions.create(
                model="gpt-4o-mini",
                messages=[{"role":"user","content":prompt}],
                temperature=0.8,
            )
            st.markdown("### âœ¨ ì˜¤ëŠ˜ì˜ ì½”ë”” ì¶”ì²œ")
            st.write(response.choices[0].message.content.strip())
# =========================================================
# SNS ë¸Œëœë”©
# =========================================================
elif page == "SNS ë¸Œëœë”© ğŸ“¸":
    st.markdown("## SNS ë¸Œëœë”© & í”¼ë“œ ì¶”ì²œ ğŸ“¸")
    line()
    msg = st.text_area("ì‚¬ì§„ì— ë‹´ê³  ì‹¶ì€ ë©”ì‹œì§€/ë¶„ìœ„ê¸° ğŸŒˆ", height=120)
    vibe = st.selectbox("ê³„ì • ì „ì²´ ë¶„ìœ„ê¸°", ["ê¾¸ì•ˆê¾¸ ë°ì¼ë¦¬", "ê³µë¶€/ê¸°ë¡ ê³„ì •", "ê°¬ì„± ì‚¬ì§„ ìœ„ì£¼", "ì¹œêµ¬ë“¤ì´ë‘ ë…¸ëŠ” ê³„ì •", "ì•„ì§ ì˜ ëª¨ë¥´ê² ìŒ"])
    photo = st.file_uploader("ì˜¬ë¦´ ì‚¬ì§„ ì¶”ê°€ ğŸ“·", type=["jpg","jpeg","png"])

    if st.button("ğŸ“¸ AI ë¸Œëœë”© ì¶”ì²œ ë°›ê¸°"):
        if not msg.strip():
            st.warning("ë©”ì‹œì§€ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.")
        else:
            prompt = f"""
ì‚¬ìš©ìê°€ ì˜¬ë¦´ ì‚¬ì§„ ë¶„ìœ„ê¸°: {vibe}
ë©”ì‹œì§€: {msg}

ìœ„ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì¸ìŠ¤íƒ€ê·¸ë¨ ë¸Œëœë”© ìš”ì†Œë¥¼ ì¶”ì²œí•´ì¤˜.
- í•„í„° ìŠ¤íƒ€ì¼
- í°íŠ¸ ìŠ¤íƒ€ì¼
- ìŒì•…/ì‚¬ìš´ë“œ
- ìº¡ì…˜ ë¬¸êµ¬
- ìŠ¤í‹°ì»¤/ê·¸ë˜í”½ ìš”ì†Œ
"""
            response = openai.chat.completions.create(
                model="gpt-4o-mini",
                messages=[{"role":"user","content":prompt}],
                temperature=0.8,
            )
            st.markdown("### âœ¨ ì¶”ì²œ ë¸Œëœë”© ìš”ì†Œ")
            st.write(response.choices[0].message.content.strip())
            if photo:
                st.image(photo, caption="ì—…ë¡œë“œí•œ ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸°", use_column_width=True)

# =========================================================
# ìš”ì¦˜ ë°ˆ ì„¤ëª… (ë§¤ê±°ì§„/ì¹¼ëŸ¼ ìŠ¤íƒ€ì¼, ì¤„ê¸€ ì „ì²´)
# =========================================================
elif page == "ìš”ì¦˜ ë°ˆ ì„¤ëª… ğŸ˜‚":
    st.markdown("## ìš”ì¦˜ ë°ˆ ì„¤ëª…ì„œ ğŸ˜‚")
    line()
    st.markdown("### ğŸ“° ì´ë²ˆ ë‹¬ ë°ˆ ë§¤ê±°ì§„")

    # ë‚´ ê³¨ë°˜ì´ ë©ˆì¶”ì§€ ì•ŠëŠ” íƒ“ì¼ê¹Œ
    with st.container(border=True):
        st.markdown("### ğŸ•º ë‚´ ê³¨ë°˜ì´ ë©ˆì¶”ì§€ ì•ŠëŠ” íƒ“ì¼ê¹Œ?")
        st.write(
             "ìš”ì¦˜ SNSë¥¼ ìŠ¤í¬ë¡¤í•˜ë‹¤ ë³´ë©´, ì–´ëŠ ìˆœê°„ â€œë‚´ ê³¨ë°˜ì´ ë©ˆì¶”ì§€ ì•ŠëŠ” íƒ“ì¼ê¹Œ?â€ë¼ëŠ” ìë§‰ê³¼ í•¨ê»˜ "
            "ê²½ì¾Œí•˜ê²Œ ì¶¤ì¶”ëŠ” ì˜ìƒì´ ëˆˆì— ë“¤ì–´ì˜¨ë‹¤. ë‹¨ìˆœí•œ ìœ í–‰ì„ ë„˜ì–´, ì´ ë°ˆì€ ë””ì§€í„¸ ì„¸ëŒ€ê°€ ëª¸ê³¼ ë¦¬ë“¬ìœ¼ë¡œ "
            "ì†Œí†µí•˜ëŠ” ìƒˆë¡œìš´ ë°©ì‹ì˜ ì–¸ì–´ë¡œ ìë¦¬ ì¡ì•˜ë‹¤.\n\n"
            "ì´ ë°ˆì˜ ë§¤ë ¥ì€ ì§ê´€ì ì´ë¼ëŠ” ì ì´ë‹¤. ê¸´ ì„¤ëª… ì—†ì´ë„ í•œëˆˆì— â€˜ë¦¬ë“¬â€™, â€˜ë¶„ìœ„ê¸°â€™, â€˜ìœ ë¨¸â€™ê°€ ì „ë‹¬ëœë‹¤. "
            "ì¹œêµ¬ì™€ ê³µìœ í•  ë•Œ, ëŒ“ê¸€ë¡œ ë°˜ì‘í•  ë•Œ, ì§§ì€ ì˜ìƒ í•œ í¸ì´ ëª¨ë‘ì˜ ê³µê°ì„ ì¦‰ì‹œ ë§Œë“¤ì–´ë‚¸ë‹¤. "
            "ìŒì•…ê³¼ ì›€ì§ì„, í…ìŠ¤íŠ¸ê°€ ê²°í•©ëœ ì´ ì‘ì€ ìˆí¼ ì†ì—ì„œ ì‚¬ëŒë“¤ì€ ì›ƒê³ , ë”°ë¼ í•˜ê³ , ë³€ì£¼í•˜ë©° "
            "ìì‹ ë§Œì˜ í•´ì„ì„ ë§ë¶™ì¸ë‹¤.\n\n"
            "ë°ˆì€ ì§§ì§€ë§Œ ê°•ë ¬í•˜ë‹¤. ìˆœê°„ì ìœ¼ë¡œ ì†Œë¹„ë˜ê³ , ë˜ ë¹ ë¥´ê²Œ ë‹¤ìŒ íŠ¸ë Œë“œë¡œ ë„˜ì–´ê°€ì§€ë§Œ, ë™ì‹œì— ì„¸ëŒ€ì˜ ê°ê°ê³¼ ìœ ë¨¸, "
            "ê·¸ë¦¬ê³  ë””ì§€í„¸ ì†Œí†µ ë°©ì‹ì„ ë°˜ì˜í•˜ëŠ” ê±°ìš¸ì´ ëœë‹¤. â€œë‚´ ê³¨ë°˜ì´ ë©ˆì¶”ì§€ ì•ŠëŠ” íƒ“ì¼ê¹Œ?â€ë¼ëŠ” í•œë§ˆë””ê°€ ì „í•˜ëŠ” ì›ƒìŒê³¼ "
            "ê³µê° ì†ì—ì„œ, ìš°ë¦¬ëŠ” ì˜¤ëŠ˜ë„ ìƒˆë¡œìš´ ë¦¬ë“¬ ìœ„ì—ì„œ ì†Œí†µí•œë‹¤.\n\n"
            "ë°ˆì€ ë©ˆì¶”ì§€ ì•ŠëŠ” ê³¨ë°˜ì²˜ëŸ¼, ì–¸ì œë‚˜ ë‹¤ìŒ ì›€ì§ì„ì„ ê¸°ë‹¤ë¦°ë‹¤. ê·¸ë¦¬ê³  ìš°ë¦¬ëŠ” ê·¸ ë¦¬ë“¬ì— ë§ì¶° ë˜ í•œ ë²ˆ ì›ƒê³ , "
            "ë°˜ì‘í•˜ë©°, ì¶¤ì¶˜ë‹¤."
        )

    line()

    # ë°¤í‹°
    with st.container(border=True):
        st.markdown("### ğŸŒ™ ë°¤í‹°")
        st.write(
            "ì˜¨ë¼ì¸ ì»¤ë®¤ë‹ˆí‹°ë¥¼ ì¡°ê¸ˆë§Œ ë“¤ì—¬ë‹¤ë³´ë©´ â€˜ë°¤í‹°â€™ë¼ëŠ” ë‹¨ì–´ê°€ ìì£¼ ëˆˆì— ëˆë‹¤. í•œë•ŒëŠ” ë‹¨ìˆœíˆ ê²Œì„ ì† í•œ ì•„ë°”íƒ€ì˜ ì´ë¦„ì—ì„œ "
            "ì‹œì‘ëœ í‘œí˜„ì´ì—ˆì§€ë§Œ, ì§€ê¸ˆì€ ì‚¬ëŒ, íŒ¨ì…˜, ë¬¼ê±´, ì‹¬ì§€ì–´ ë¶„ìœ„ê¸°ê¹Œì§€ë„ ê°€ë³ê²Œ í‰ê°€í•˜ëŠ” ë°ˆ ì–¸ì–´ë¡œ ìë¦¬ ì¡ì•˜ë‹¤.\n\n"
            "ë°¤í‹°ì˜ ë§¤ë ¥ì€ ì§§ê³  ì§ê´€ì ì´ë¼ëŠ” ë° ìˆë‹¤. í•œë§ˆë””ë¡œ ì‚¬ëŒë“¤ì—ê²Œ ì¸ìƒì ì¸ ëŠë‚Œì„ ì „ë‹¬í•  ìˆ˜ ìˆìœ¼ë©°, ê³¼ì¥ëœ í‘œí˜„ì„ í†µí•´ "
            "ì¬ë¯¸ì™€ ìœ ë¨¸ë¥¼ ë™ì‹œì— ë‹´ëŠ”ë‹¤. â€œì´ë²ˆ ì˜· ì™„ì „ ë°¤í‹° ë‚œë‹¤â€ë¼ê³  í•˜ë©´, ì´ŒìŠ¤ëŸ½ê±°ë‚˜ ê³¼í•œ ëŠë‚Œì„ ë°”ë¡œ ë– ì˜¬ë¦¬ê²Œ í•˜ë©´ì„œë„ ì›ƒìŒì„ ì¤€ë‹¤. "
            "ë§í•˜ìë©´, ë°¤í‹°ëŠ” ì˜¨ë¼ì¸ ì„¸ëŒ€ê°€ ë§Œë“¤ì–´ë‚¸ â€˜ê°ì • ì „ë‹¬í˜• ì‹ ì¡°ì–´â€™ì¸ ì…ˆì´ë‹¤.\n\n"
            "í¥ë¯¸ë¡œìš´ ì ì€ ì´ ë‹¨ì–´ê°€ ë‹¨ìˆœí•œ í’ìë‚˜ í‰ê°€ì— ê·¸ì¹˜ì§€ ì•Šê³ , ìê¸° ë¹„í•˜ì  ìœ ë¨¸ë‚˜ ì¹œê·¼í•œ ë†ë‹´ìœ¼ë¡œë„ ì“°ì¸ë‹¤ëŠ” ê²ƒì´ë‹¤. "
            "â€œì˜¤ëŠ˜ ë‚´ ìŠ¤íƒ€ì¼ ë°¤í‹° ì™„ì „ í­ë°œâ€ì´ë¼ëŠ” ì‹ìœ¼ë¡œ, ìì‹ ì˜ ê³¼ì¥ëœ ëª¨ìŠµì„ ì¬ì¹˜ ìˆê²Œ í‘œí˜„í•  ë•Œë„ í™œìš©ëœë‹¤. "
            "ì´ì²˜ëŸ¼ ë°¤í‹°ëŠ” ë°ˆìœ¼ë¡œì„œ ì¬ë¯¸ë¥¼ ì£¼ëŠ” ë™ì‹œì—, ì˜¨ë¼ì¸ ì†Œí†µì—ì„œ ìì—°ìŠ¤ëŸ½ê²Œ ê°ì •ê³¼ ë¶„ìœ„ê¸°ë¥¼ ì „ë‹¬í•˜ëŠ” ì—­í• ì„ í•œë‹¤.\n\n"
            "ê²°êµ­ ë°¤í‹°ëŠ” ë‹¨ìˆœí•œ ìœ í–‰ì–´ë¥¼ ë„˜ì–´, ë””ì§€í„¸ ì‹œëŒ€ ì Šì€ ì„¸ëŒ€ê°€ ì–¸ì–´ë¡œ ìœ ë¨¸ì™€ ê°ì •ì„ ì¡°ìœ¨í•˜ëŠ” ë°©ì‹ì˜ í•œ ì˜ˆë¼ê³  í•  ìˆ˜ ìˆë‹¤. "
            "ì§§ì§€ë§Œ ê°•ë ¬í•œ ì¸ìƒì„ ì£¼ëŠ” í•œ ë‹¨ì–´ ì•ˆì—, ì˜¨ë¼ì¸ ë¬¸í™”ì˜ ìœ ì—°í•¨ê³¼ ì¬ë¯¸ê°€ ê³ ìŠ¤ë€íˆ ë‹´ê²¨ ìˆëŠ” ì…ˆì´ë‹¤. "
            "ì˜¤ëŠ˜ë„ ìš°ë¦¬ëŠ” ëŒ“ê¸€ê³¼ ì±„íŒ… ì†ì—ì„œ, ì›ƒìŒê³¼ ê°ì •ì„ ë‹´ì•„ â€˜ë°¤í‹°â€™ í•œ ë§ˆë””ë¥¼ ë˜ì§€ë©° ì†Œí†µí•œë‹¤."
        )

    line()

    # ì•„ììŠ¤
    with st.container(border=True):
        st.markdown("### ğŸ™Œ ì•„ììŠ¤")
        st.write(
            "ìµœê·¼ ì˜¨ë¼ì¸ê³¼ SNSë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ì Šì€ ì„¸ëŒ€ ì‚¬ì´ì—ì„œ ìœ í–‰í•˜ëŠ” â€˜ì•„ììŠ¤â€™ë¼ëŠ” í‘œí˜„ì„ ë§ˆì£¼í•  ë•Œë©´, "
            "ê·¸ ë‹¨ìˆœí•œ ì„¸ ê¸€ì ì•ˆì— ë‹´ê¸´ ë¬¸í™”ì  ì˜ë¯¸ê°€ ë¬˜í•˜ê²Œ í¥ë¯¸ë¡­ë‹¤. ì•„ììŠ¤ëŠ” ì¼ë³¸ì–´ â€˜ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™(ê°ì‚¬í•©ë‹ˆë‹¤)â€™ì˜ "
            "êµ¬ì–´ì²´ ì¶•ì•½í˜•ìœ¼ë¡œ, ì›ë˜ ì¼ë³¸ ì²­ë…„ì¸µ ì‚¬ì´ì—ì„œ ì“°ì´ë˜ ì¹œê·¼í•œ ê°ì‚¬ í‘œí˜„ì´ í•œêµ­ì˜ ì¸í„°ë„· ì»¤ë®¤ë‹ˆí‹°ì™€ ëŒ“ê¸€ ë¬¸í™” ì†ìœ¼ë¡œ "
            "ìì—°ìŠ¤ëŸ½ê²Œ í˜ëŸ¬ë“¤ì–´ì˜¨ ê²ƒì´ë‹¤. ì§§ê³  ê²½ì¾Œí•œ ë°œìŒ ë•ë¶„ì— ëŒ“ê¸€, ì±„íŒ…, ì˜ìƒ ë¦¬ì•¡ì…˜ ë“± ë‹¤ì–‘í•œ ë§¥ë½ì—ì„œ ì‰½ê²Œ ì“°ì´ë©´ì„œ "
            "â€˜ê°ì‚¬â€™ë¥¼ ë„˜ì–´ â€˜ê³µê°â€™, â€˜ì¸ì •â€™, â€˜ìœ ë¨¸â€™ì˜ ì˜ë¯¸ê¹Œì§€ í¬ê´„í•˜ê²Œ ë˜ì—ˆë‹¤.\n\n"
            "ê·¸ëŸ°ë° ì•„ììŠ¤ê°€ í¥ë¯¸ë¡œìš´ ì´ìœ ëŠ” ë‹¨ìˆœíˆ ì™¸ë˜ì–´ì˜ ìœ í–‰ì´ë¼ëŠ” ì ì— ìˆì§€ ì•Šë‹¤. ì´ê²ƒì€ ì˜¨ë¼ì¸ ì„¸ëŒ€ê°€ ì†Œí†µì—ì„œ ì›í•˜ëŠ” ê²ƒ, "
            "ì¦‰ ë¹ ë¥¸ ë°˜ì‘ê³¼ ì¦‰ê°ì ì¸ ê°ì • ê³µìœ , ê·¸ë¦¬ê³  ì¹œë°€í•œ ìœ ëŒ€ê°ì„ í•œ ë‹¨ì–´ë¡œ ë‹´ì•„ë‚´ë ¤ëŠ” ì‹œë„ì˜ ê²°ê³¼ë‹¤. ì¹œêµ¬ì™€ì˜ ëŒ€í™”ì—ì„œ, "
            "í˜¹ì€ ëŒ“ê¸€ì—ì„œ â€˜ì•„ììŠ¤â€™ë¼ê³  í•œë§ˆë”” ê±´ë„¤ë©´, ë‹¨ìˆœí•œ ê°ì‚¬ì˜ ì˜ë¯¸ë¥¼ ë„˜ì–´ì„œ ìƒëŒ€ë°©ì„ í–¥í•œ ê¸ì •ê³¼ ê³µê°, ë•Œë¡œëŠ” ìœ ë¨¸ëŸ¬ìŠ¤í•œ "
            "ë“œë¦½ê¹Œì§€ ë‹´ì•„ë‚¼ ìˆ˜ ìˆë‹¤.\n\n"
            "í•˜ì§€ë§Œ ëª¨ë“  ìœ í–‰ì–´ê°€ ê·¸ë ‡ë“¯, ì•„ììŠ¤ ì—­ì‹œ ë§¥ë½ì„ ë²—ì–´ë‚˜ë©´ ì˜¤í•´ë¥¼ ë¶€ë¥¼ ìˆ˜ ìˆë‹¤. ê³µì‹ì ì¸ ìë¦¬ë‚˜ ì²˜ìŒ ë§Œë‚œ ì‚¬ëŒê³¼ì˜ "
            "ëŒ€í™”ì—ì„œ ì‚¬ìš©í•˜ë©´ ê²©ì‹ ì—†ëŠ” í‘œí˜„ìœ¼ë¡œ ë¹„ì¹  ìˆ˜ ìˆê³ , ì¼ë¶€ ì»¤ë®¤ë‹ˆí‹°ì—ì„œëŠ” ë¹„íŒì´ë‚˜ ëƒ‰ì†Œë¥¼ ë‹´ì€ ë’¤ â€˜ì•„ììŠ¤â€™ë¥¼ ë¶™ì´ëŠ” ë°©ì‹ìœ¼ë¡œ "
            "ì›ë˜ ì˜ë¯¸ë¥¼ íë¦¬ëŠ” ê²½ìš°ë„ ìˆë‹¤. ê²°êµ­ ì–¸ì–´ëŠ” ì˜ì‚¬ì†Œí†µì˜ ë„êµ¬ì´ì ë¬¸í™”ì˜ í‘œí˜„ì´ë¼ëŠ” ì ì—ì„œ, ì¹œê·¼í•˜ê³  ê°„ê²°í•œ í‘œí˜„ì´ë¼ë„ "
            "ì‚¬ìš© ë§¥ë½ê³¼ ìƒëŒ€ë°©ì„ ê³ ë ¤í•˜ëŠ” ì§€í˜œê°€ í•„ìš”í•˜ë‹¤.\n\n"
            "ì•„ììŠ¤ëŠ” ì„¸ëŒ€ì™€ ë¬¸í™”ê°€ ë§Œë“¤ì–´ë‚¸ ì–¸ì–´ì  ìœ í¬ì´ì, ì‹œëŒ€ê°€ ìš”êµ¬í•˜ëŠ” ì†Œí†µ ë°©ì‹ì˜ í•œ ë‹¨ë©´ì´ë‹¤. ì§§ì€ ë‹¨ì–´ ì†ì— ê°ì •ê³¼ ê³µê°, "
            "ìœ ë¨¸ì™€ ì¹œë°€ê°ì„ ë‹´ì•„ë‚´ëŠ” ëŠ¥ë ¥ì€, ë””ì§€í„¸ ì‹œëŒ€ì˜ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ì´ ì–¼ë§ˆë‚˜ ë¹ ë¥´ê³  ê°ê°ì ì´ë©° ë™ì‹œì— ë¯¸ë¬˜í•˜ê²Œ ì‚¬íšŒì  ì˜ë¯¸ë¥¼ "
            "ë ê³  ìˆëŠ”ì§€ë¥¼ ë³´ì—¬ì¤€ë‹¤. ê·¸ëŸ¬ë‚˜ ê·¸ ì†ì— ë‹´ê¸´ ì˜ë¯¸ë¥¼ ì œëŒ€ë¡œ ì´í•´í•˜ì§€ ëª»í•œ ì±„ ë‚¨ìš©í•  ê²½ìš°, ìœ ë¨¸ê°€ ëƒ‰ì†Œë¡œ, ì¹œê·¼ê°ì´ ë¬´ë¡€ë¡œ "
            "ë³€í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì„ ìŠì–´ì„œëŠ” ì•ˆ ëœë‹¤. ì•„ììŠ¤ë¼ëŠ” ë‹¨ì–´ëŠ”, ê·¸ë˜ì„œ ë‹¨ìˆœí•œ ë°ˆì´ ì•„ë‹ˆë¼, ë””ì§€í„¸ ë¬¸í™” ì† ì†Œí†µì˜ ìœ ì—°í•¨ê³¼ "
            "ì±…ì„ì„ ë™ì‹œì— ìƒê°í•˜ê²Œ í•˜ëŠ” ì‘ì€ ì–¸ì–´ ì‹¤í—˜ì¸ ì…ˆì´ë‹¤."
        )

# =========================================================
# ì˜¤ëŠ˜ì˜ ë°¤í‹° ì ìˆ˜
# =========================================================
elif page == "ì˜¤ëŠ˜ì˜ ë°¤í‹° ì ìˆ˜ ğŸ”®":
    st.markdown("## ì˜¤ëŠ˜ì˜ ë°¤í‹° ì ìˆ˜ ë¶„ì„ ğŸ”®")
    line()
    st.write("ê° í•­ëª©ì„ ì˜¤ëŠ˜ ê¸°ë¶„ëŒ€ë¡œ ì„ íƒ (1 = ì „í˜€ ì•„ë‹ˆë‹¤, 5 = ë§¤ìš° ê·¸ë ‡ë‹¤)")
    q1 = st.slider("ëŒ€í™”í•  ì¤€ë¹„ ğŸ˜„", 1,5,3)
    q2 = st.slider("ì˜·ì°¨ë¦¼ ë§Œì¡± ğŸ‘—", 1,5,3)
    q3 = st.slider("SNSì— ì˜¬ë¦¬ê³  ì‹¶ì€ ë§ˆìŒ ğŸ“¸",1,5,3)
    q4 = st.slider("ë©˜íƒˆ ì•ˆì • ğŸ§ ",1,5,3)
    q5 = st.slider("ìƒˆë¡œìš´ ë„ì „ ì •ì‹  ğŸš€",1,5,3)

    if st.button("ğŸ”® ì˜¤ëŠ˜ì˜ ë°¤í‹° ì ìˆ˜ ë³´ê¸°"):
        raw_score = q1 + q2 + q3 + q4 + q5
        max_score = 25
        score = int(raw_score / max_score * 100)
        st.markdown("### âœ¨ ì˜¤ëŠ˜ì˜ ë°¤í‹° ì¢…í•© ì ìˆ˜")
        st.metric("ì˜¤ëŠ˜ì˜ BAME ë°¤í‹° ì ìˆ˜", f"{score} / 100")

        if score >= 80:
            msg = "ì˜¤ëŠ˜ ë°¤í‹° ì ìˆ˜ ìµœìƒìœ„ ğŸ’œ ë¬´ì—‡ì„ í•´ë„ ì˜ í’€ë¦´ ê¸°ì„¸ì˜ˆìš”."
        elif score >= 60:
            msg = "ì˜¤ëŠ˜ ê½¤ ê´œì°®ì€ ìƒíƒœì˜ˆìš” ğŸ™‚ ì•½ê°„ì˜ íœ´ì‹ë§Œ ì±™ê¸°ë©´ ë¶€ë“œëŸ½ê²Œ í˜ëŸ¬ê°ˆ ê±°ì˜ˆìš”."
        elif score >= 40:
            msg = "ì¡°ê¸ˆ í”¼ê³¤í•˜ê±°ë‚˜ ì˜ˆë¯¼í•  ìˆ˜ ìˆëŠ” ë‚ ì´ì—ìš”. ì˜¤ëŠ˜ì€ ê°€ë³ê²Œ ê¸°ë¡ë§Œ ë‚¨ê²¨ë„ ì¢‹ì•„ìš” ğŸŒ±"
        else:
            msg = "ì§€ê¸ˆì€ ì‰¬ì–´ì•¼ í•˜ëŠ” íƒ€ì´ë°ì¼ ìˆ˜ë„ ìˆì–´ìš”. ë‚®ì€ ì ìˆ˜ë„ ê´œì°®ì•„ìš”. ì¶©ì „ì˜ ì‹œê°„ì…ë‹ˆë‹¤ â˜ï¸"

        st.info(msg)
